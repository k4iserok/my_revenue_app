# Расчет выручек

## 1. Выручка от продаж терминалов

Выручка от продаж терминалов основывается на данных о прогнозируемых продажах в `sales_data`.

\[
\text{Выручка от продаж} = \text{Продажи за год} \times \text{Стоимость одного терминала}
\]

- **Продажи за год**: Для каждого года берется общее количество проданных терминалов из `sales_data`.
- **Расчет выручки от продаж**:

\[
\text{Выручка от продаж} = \text{Продажи за год} \times \text{cost\_AT}
\]

## 2. Накопительный итог терминалов (база АТ)

Накопительный итог терминалов рассчитывается для каждого года, начиная с 2026 года, с учетом проданных терминалов, которые добавляются ежегодно:

\[
\text{Накопительный итог терминалов} = \text{Накопительный итог терминалов предыдущего года} + \text{Продажи за текущий год}
\]

Этот накопительный итог используется для расчетов выручек от аренды и услуг связи, учитывая, что терминалы, добавленные в предыдущих годах, остаются в базе.

## 3. Выручка от аренды терминалов

Выручка от аренды рассчитывается на основе накопительного итога терминалов, которые доступны в аренду (из базы АТ), и доли арендуемых терминалов (`rental_share`).

\[
\text{Выручка от аренды} = \left( \text{Накопительный итог терминалов} \times \frac{\text{rental\_share}}{100} \right) \times \text{Ежемесячная плата} \times 12
\]

- **Терминалы для аренды**: Берется `rental_share` от накопительного итога терминалов.
- **Годовая выручка от аренды**:

\[
\text{Выручка от аренды} = \left( \text{Накопительный итог терминалов} \times \frac{\text{rental\_share}}{100} \right) \times \text{monthly\_rent} \times 12
\]

## 4. Выручка от услуг связи

Выручка от услуг связи рассчитывается для каждого сегмента и подкатегории с учетом:

- Накопительного количества терминалов (которые используются для связи),
- Тарифа для каждого сегмента,
- Индексации тарифов,
- Оттока (churn rate).

\[
\text{Выручка от услуг связи} = \sum_{i=1}^{N} \left( \text{Накопительный итог терминалов}_i \times \text{Тариф}_i \times (1 - \text{Отток}_i) \times (1 + \text{Индексация}) \right)
\]

Для каждого сегмента и подкатегории:

- **Тариф**: Тариф берется из `tariffs_and_ottok`.
- **Отток**: Отток (`churn_rate`) для каждого сегмента и подкатегории также берется из `tariffs_and_ottok`. Он показывает долю терминалов, которые теряются, поэтому умножается на \((1 - \text{churn\_rate})\).
- **Индексация**: Индексация тарифа добавляется в зависимости от года и местоположения сегмента (Россия или зарубежные страны).

### Выручка от связи для сегмента:

\[
\text{Выручка для сегмента} = \text{Накопительный итог терминалов}_i \times \text{Тариф}_i \times (1 - \text{churn\_rate}) \times \left(1 + \frac{\text{indexation}}{100}\right)
\]

Суммируем по всем сегментам и подкатегориям для получения общей выручки от связи.

## Общая выручка

Общая выручка за каждый год складывается из выручек от продаж, аренды и услуг связи:

\[
\text{Общая выручка} = \text{Выручка от продаж} + \text{Выручка от аренды} + \text{Выручка от услуг связи}
\]
